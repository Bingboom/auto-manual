% ==================================================
% components_safety.tex
% INDUSTRIAL STABLE VERSION
% ==================================================

\usepackage{titlesec}
\usepackage[most]{tcolorbox}
\usepackage{array}
\usepackage{graphicx}
\usepackage{multicol}

% ==================================================
% SAFE DEFAULTS (防止参数未定义)
% ==================================================

\providecommand{\HBwarn_text_uppercase}{0}
\providecommand{\HBtitle_force_upper}{0}
\providecommand{\HBlead_force_upper}{0}
\providecommand{\HBsection_after_fix}{0pt}

% ==================================================
% WARNING LOCKUP
% ==================================================

\providecommand{\warninglockup}{}
\renewcommand{\warninglockup}{%
  \includegraphics[
    height=\csname HBwarn_lockup_height\endcsname,
    viewport=79 22 2125 549,
    clip
  ]{warning_lockup.png}%
}


% ==================================================
% WARNING BOX
% ==================================================

\newtcolorbox{safetywarningbox}{
  enhanced,
  colback=white,
  colframe=LineK40,
  arc=\csname HBwarn_box_arc\endcsname,
  boxrule=\csname HBwarn_box_rule\endcsname,
  left=\csname HBwarn_box_pad_lr\endcsname,
  right=\csname HBwarn_box_pad_lr\endcsname,
  top=\csname HBwarn_box_pad_tb\endcsname,
  bottom=\csname HBwarn_box_pad_tb\endcsname,
  before skip=\csname HBwarn_box_before\endcsname,
  after skip=\csname HBwarn_box_after\endcsname,
  width=\csname HBwarn_box_width\endcsname\textwidth,
}

% ==================================================
% WARNING LAYOUT
% ==================================================

\providecommand{\safetywarning}[1]{}
\renewcommand{\safetywarning}[1]{%
\begin{safetywarningbox}
  \noindent
  \begin{tabular}{@{}m{\csname HBwarn_lockup_width\endcsname}%
                  @{\hspace{\csname HBwarn_lockup_gap\endcsname}}%
                  m{\dimexpr\textwidth-\csname HBwarn_lockup_width\endcsname-\csname HBwarn_lockup_gap\endcsname\relax}@{}}
    \centering\warninglockup
    &
    \raggedright
    {\bfseries
     \fontsize{\csname HBwarn_text_size\endcsname}{\csname HBwarn_text_leading\endcsname}\selectfont
     #1
    }
  \end{tabular}
\end{safetywarningbox}
}

% ==================================================
% SUBBAR
% ==================================================

\providecommand{\safetysubbar}[1]{}
\renewcommand{\safetysubbar}[1]{%
  \begin{tcolorbox}[
    colback=BrandDark,
    colframe=BrandDark,
    arc=\csname HBsubbar_arc\endcsname,
    left=\csname HBsubbar_pad_lr\endcsname,
    right=\csname HBsubbar_pad_lr\endcsname,
    top=\csname HBsubbar_pad_tb\endcsname,
    bottom=\csname HBsubbar_pad_tb\endcsname,
    boxrule=0pt,
    width=\csname HBsubbar_width\endcsname\textwidth
  ]
  {\color{white}\bfseries
   \fontsize{\csname HBtitle_font_size\endcsname}{\csname HBtitle_font_leading\endcsname}\selectfont
   #1}
  \end{tcolorbox}
  \vspace{\csname HBsubbar_vspace_after\endcsname}
}

% ==================================================
% TWO COLUMN
% ==================================================

\setlength{\columnsep}{\csname HBtwocol_sep\endcsname}

\newenvironment{safetytwocol}{%
  \begin{multicols}{2}
  \fontsize{\csname HBtwocol_font_size\endcsname}{\csname HBtwocol_font_leading\endcsname}\selectfont
}{%
  \end{multicols}
}

% ==================================================
% H1 PILL
% ==================================================

\providecommand{\hbsectiontitle}[1]{#1}

\renewcommand{\hbsectiontitle}[1]{%
  \par\noindent
  \hspace*{-\leftskip}%
  \begin{tcolorbox}[
    colback=BrandDark,
    colframe=BrandDark,
    arc=\csname HBbrand_title_arc\endcsname,
    boxrule=0pt,
    left=\csname HBbrand_title_pad_lr\endcsname,
    right=\csname HBbrand_title_pad_lr\endcsname,
    top=\csname HBbrand_title_pad_tb\endcsname,
    bottom=\csname HBbrand_title_pad_tb\endcsname,
    width=\csname HBbrand_title_width\endcsname\textwidth,
    before skip=0mm,
    after skip=\csname HBbrand_title_vspace_after\endcsname
  ]
  {\color{white}\bfseries
   \fontsize{\csname HBtitle_font_size\endcsname}{\csname HBtitle_font_leading\endcsname}\selectfont
   #1}
  \end{tcolorbox}%
  \par\noindent
}

% ==================================================
% LEAD
% ==================================================

\providecommand{\safetylead}[1]{}
\renewcommand{\safetylead}[1]{%
  \par\noindent
  {\bfseries
   \fontsize{\csname HBlead_font_size\endcsname}{\csname HBlead_font_leading\endcsname}\selectfont
   #1}
  \par\vspace{\csname HBlead_vspace_after\endcsname}
}

% ==================================================
% SECTION PATCH
% ==================================================

\titleformat{\section}{\normalfont}{}{0pt}{\hbsectiontitle}
\titlespacing*{\section}{0pt}{0pt}{\csname HBsection_after_fix\endcsname}
\setcounter{secnumdepth}{0}
